{
  "schema_version": "1.0",
  "plan_template_id": "Documents.Upload@1.0.0",
  "intent_type": "Documents.Upload",
  "plan_version": "planner-1.0",
  "description": "Record an uploaded document in the document ledger with dedupe by hash.",
  "steps": [
    {
      "step_id": "s1",
      "kind": "operator",
      "name": "Documents.Upload",
      "operator_name": "Documents.Upload",
      "operator_version": "1.0.0",
      "effects": ["db_write", "s3_sandbox_write"],
      "policy_tags": ["documents"],
      "risk_level": "low",
      "cache_policy": "never",
      "idempotency_template": "doc_upload:{tenant_id}:{intent.thread_id}:{intent.inputs.artifact.hash.value}:{intent.inputs.document_type}",
      "payload": {
        "student_id": { "from": "intent.actor.principal.id" },
        "thread_id": { "from": "intent.thread_id" },
        "document_type": { "from": "intent.inputs.document_type" },
        "title": { "from": "intent.inputs.title" },
        "lifecycle": { "from": "intent.inputs.lifecycle" },
        "artifact": { "from": "intent.inputs.artifact" }
      },
      "produces": ["outcome.document_uploaded"]
    }
  ]
}
